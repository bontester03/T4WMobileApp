<?xml version="1.0" encoding="UTF-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:chart="clr-namespace:Syncfusion.Maui.Charts;assembly=Syncfusion.Maui.Charts"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="T4sV1.Views.WeeklyMeasurementsPage"
             Title="Weekly Measurements"
             BackgroundColor="#FAFAFA">

    <ScrollView>
        <ScrollView.Background>
            <!-- StartPoint defaults to (0,0) -->
            <LinearGradientBrush EndPoint="0,1">
                <GradientStop Color="#e9fdb6" Offset="0.1" />
                <GradientStop Color="#9dc052" Offset="1.0" />
            </LinearGradientBrush>
        </ScrollView.Background>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Header -->
            <Label Text="ðŸ“ Weekly Measurements"
                   FontSize="28"
                   FontAttributes="Bold"
                   TextColor="#2C3E50"
                   HorizontalOptions="Center" />

            <!-- Measurement Cards -->
            <CollectionView ItemsSource="{Binding Measurements}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Stroke="#D1D1D1"
                                StrokeThickness="1"
                                 BackgroundColor="#f6ffe4"
                                StrokeShape="RoundRectangle 12"
                                Padding="20"
                                Margin="0,10">
                            <Border.Shadow>
                                <Shadow Brush="Black"
                                        Offset="2,2"
                                        Radius="4"
                                        Opacity="0.15" />
                            </Border.Shadow>
                            <Grid ColumnSpacing="10" RowSpacing="12">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Text="ðŸ“… Date:" FontAttributes="Bold" TextColor="#34495E" />
                                <Label Grid.Row="0" Grid.Column="1" Text="{Binding DateRecorded, StringFormat='{}{0:dd MMM yyyy}'}" TextColor="#2C3E50" />

                                <Label Grid.Row="1" Grid.Column="0" Text="ðŸ“ Height:" FontAttributes="Bold" TextColor="#34495E" />
                                <Label Grid.Row="1" Grid.Column="1" Text="{Binding Height, StringFormat='{}{0} cm'}" TextColor="#2C3E50" />

                                <Label Grid.Row="2" Grid.Column="0" Text="âš–ï¸ Weight:" FontAttributes="Bold" TextColor="#34495E" />
                                <Label Grid.Row="2" Grid.Column="1" Text="{Binding Weight, StringFormat='{}{0} kg'}" TextColor="#2C3E50" />

                                <Label Grid.Row="3" Grid.Column="0" Text="ðŸ“Š Centile:" FontAttributes="Bold" TextColor="#34495E" />
                                <Label Grid.Row="3" Grid.Column="1" Text="{Binding CentileScore}" TextColor="#2C3E50" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Chart Tabs -->
            <!-- Toggle Buttons -->
            <Grid ColumnDefinitions="*,*,*,*" Padding="0,10">
                <Button Text="Weight" Margin="5,0" Clicked="OnMetricSelected" CommandParameter="Weight" Grid.Column="0"/>
                <Button Text="Height" Margin="5,0" Clicked="OnMetricSelected" CommandParameter="Height" Grid.Column="1"/>
                <Button Text="Centile" Margin="5,0" Clicked="OnMetricSelected" CommandParameter="Centile" Grid.Column="2"/>
                <Button Text="All" Margin="5,0" Clicked="OnMetricSelected" CommandParameter="All" Grid.Column="3"/>
            </Grid>


            <!-- Chart -->
            <chart:SfCartesianChart x:Name="MeasurementChart"
                        HeightRequest="300"
                        Margin="0,10,0,20">
                <chart:SfCartesianChart.XAxes>
                    <chart:DateTimeAxis Interval="1" IntervalType="Days">
                        <chart:DateTimeAxis.LabelStyle>
                            <chart:ChartAxisLabelStyle LabelFormat="dd MMM" />
                        </chart:DateTimeAxis.LabelStyle>
                    </chart:DateTimeAxis>
                </chart:SfCartesianChart.XAxes>

                <chart:SfCartesianChart.YAxes>
                    <chart:NumericalAxis />
                </chart:SfCartesianChart.YAxes>
            </chart:SfCartesianChart>


        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
